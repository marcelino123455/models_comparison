/home/marcelino.maita/.venv/lib/python3.13/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/marcelino.maita/musica_ia_workshop/models_comparison/baseline_clean/main_limit.py:222: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda grp: grp.sample(n=n_min, random_state=RANDOM_STATE))
/home/marcelino.maita/.venv/lib/python3.13/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/marcelino.maita/musica_ia_workshop/models_comparison/baseline_clean/main_limit.py:222: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda grp: grp.sample(n=n_min, random_state=RANDOM_STATE))
You are executing with [ALL] dataset

##################################################
Running experiment with TFIDF embeddings
Preprocessing text...
Label distribution: {0: 82336, 1: 25802}
X shape: (108138, 5000)
y shape: (108138,)

Splitting data...

Data con el spliting...
Label distribution en TRAIN: {0: 65868, 1: 20642}
Label distribution en TEST: {0: 16468, 1: 5160}
==================================================
Data antes del undersampling ...
X: (86510, 2)
y: (86510,)
Apliying UNDERSAMPLE
20642
Label distribution: {0: 20642, 1: 20642}
X shape: (41284, 2)
y shape: (41284,)

==============================
Model: Logistic Regression
Accuracy:  0.5997
Precision: 0.3290
Recall:    0.6521
F1-score:  0.4374
              precision    recall  f1-score   support

           0       0.84      0.58      0.69     16468
           1       0.33      0.65      0.44      5160

    accuracy                           0.60     21628
   macro avg       0.59      0.62      0.56     21628
weighted avg       0.72      0.60      0.63     21628

[[9605 6863]
 [1795 3365]]
Hiperparámetros: {'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 1000, 'multi_class': 'deprecated', 'n_jobs': None, 'penalty': 'l2', 'random_state': 42, 'solver': 'lbfgs', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/conf_matrix_logistic_regression.png
Modelo guardado como: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/logistic_regression_model.pkl
Gráfico guardado en outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/decision_boundary_logistic_regression.png

==============================
Model: Decision Tree
Accuracy:  0.6760
Precision: 0.3918
Recall:    0.6479
F1-score:  0.4883
              precision    recall  f1-score   support

           0       0.86      0.68      0.76     16468
           1       0.39      0.65      0.49      5160

    accuracy                           0.68     21628
   macro avg       0.63      0.67      0.63     21628
weighted avg       0.75      0.68      0.70     21628

[[11278  5190]
 [ 1817  3343]]
Hiperparámetros: {'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'entropy', 'max_depth': 10, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'random_state': 42, 'splitter': 'best'}
Confusion matrix saved as: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/conf_matrix_decision_tree.png
Modelo guardado como: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/decision_tree_model.pkl
Gráfico guardado en outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/tfidf/decision_boundary_decision_tree.png


Resumen de métricas:
Decision Tree: {'accuracy': 0.676, 'precision': 0.3918, 'recall': 0.6479, 'f1_score': 0.4883}
Logistic Regression: {'accuracy': 0.5997, 'precision': 0.329, 'recall': 0.6521, 'f1_score': 0.4374}

##################################################
Running experiment with LYRICS_BERT embeddings
Loading Lb vectors from:  ../data/spotify_dataset_sin_duplicados_4.csv
Label distribution: {0: 82336, 1: 25802}
X shape: (108138, 300)
y shape: (108138,)

Splitting data...

Data con el spliting...
Label distribution en TRAIN: {0: 65868, 1: 20642}
Label distribution en TEST: {0: 16468, 1: 5160}
==================================================
Data antes del undersampling ...
X: (86510, 2)
y: (86510,)
Apliying UNDERSAMPLE
20642
Label distribution: {0: 20642, 1: 20642}
X shape: (41284, 2)
y shape: (41284,)

==============================
Model: Logistic Regression
Accuracy:  0.6178
Precision: 0.3387
Recall:    0.6322
F1-score:  0.4411
              precision    recall  f1-score   support

           0       0.84      0.61      0.71     16468
           1       0.34      0.63      0.44      5160

    accuracy                           0.62     21628
   macro avg       0.59      0.62      0.58     21628
weighted avg       0.72      0.62      0.65     21628

[[10100  6368]
 [ 1898  3262]]
Hiperparámetros: {'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 1000, 'multi_class': 'deprecated', 'n_jobs': None, 'penalty': 'l2', 'random_state': 42, 'solver': 'lbfgs', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/conf_matrix_logistic_regression.png
Modelo guardado como: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/logistic_regression_model.pkl
Gráfico guardado en outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/decision_boundary_logistic_regression.png

==============================
Model: Decision Tree
Accuracy:  0.6778
Precision: 0.3937
Recall:    0.6490
F1-score:  0.4901
              precision    recall  f1-score   support

           0       0.86      0.69      0.76     16468
           1       0.39      0.65      0.49      5160

    accuracy                           0.68     21628
   macro avg       0.63      0.67      0.63     21628
weighted avg       0.75      0.68      0.70     21628

[[11311  5157]
 [ 1811  3349]]
Hiperparámetros: {'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'entropy', 'max_depth': 10, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'random_state': 42, 'splitter': 'best'}
Confusion matrix saved as: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/conf_matrix_decision_tree.png
Modelo guardado como: outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/decision_tree_model.pkl
Gráfico guardado en outputs_limi/undersample_True_scaled_True_steaming_True_removestw_True_numeric_True_5000_tfidf_A/lyrics_bert/decision_boundary_decision_tree.png


Resumen de métricas:
Decision Tree: {'accuracy': 0.6778, 'precision': 0.3937, 'recall': 0.649, 'f1_score': 0.4901}
Logistic Regression: {'accuracy': 0.6178, 'precision': 0.3387, 'recall': 0.6322, 'f1_score': 0.4411}
You are executing with this configuration: undersample_True_scaled_True_removestw_True_5000tfidf
