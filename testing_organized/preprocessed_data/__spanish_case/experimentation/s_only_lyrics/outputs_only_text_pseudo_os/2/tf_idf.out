2025-10-30 04:16:41.087401: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 04:16:41.087401: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
For TF-IDF embbedings you are selecteing this columns:
--> ['lyrics']
Your are not adding cols numercis
You are executing with [ALL] dataset
--> PaTH:  ../../../../../data/spanish/LB_T/LB_fuss/lb_khipu_T.npy

##################################################
Running experiment with TFIDF embeddings
Preprocessing text...
Label distribution: {False: 6765, True: 554}

Data con el spliting...
Label distribution en TRAIN: {0: 5412, 1: 443}
Label distribution en TEST: {0: 1353, 1: 111}




Aplicando SMOTE oversampling...
Nueva distribución de clases: {0: 5412, 1: 5412}
Resultados con MLP

Entrenando red 1 con capas [5000, 32, 1]

--- Iteración 1 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3835, Test Loss: 0.2420, F1: 0.5547, AUC: 0.9104
Epoch [10/30] Train Loss: 0.0042, Test Loss: 0.3146, F1: 0.4851, AUC: 0.8730
Epoch [20/30] Train Loss: 0.0014, Test Loss: 0.3980, F1: 0.4752, AUC: 0.8693
Mejores resultados en la época:  1
f1-score 0.5606694560669456
AUC según el mejor F1-score 0.9040437333120259
Confusion Matrix:
 [[1292   61]
 [  44   67]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9283
Precision:  0.5234
Recall:     0.6036
F1-score:   0.5607

--- Iteración 2 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3956, Test Loss: 0.2556, F1: 0.5385, AUC: 0.9118
Epoch [10/30] Train Loss: 0.0040, Test Loss: 0.3125, F1: 0.4808, AUC: 0.8711
Epoch [20/30] Train Loss: 0.0011, Test Loss: 0.3947, F1: 0.4706, AUC: 0.8648
Mejores resultados en la época:  1
f1-score 0.5630252100840336
AUC según el mejor F1-score 0.9026853904902685
Confusion Matrix:
 [[1293   60]
 [  44   67]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9290
Precision:  0.5276
Recall:     0.6036
F1-score:   0.5630

--- Iteración 3 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3874, Test Loss: 0.2437, F1: 0.5568, AUC: 0.9118
Epoch [10/30] Train Loss: 0.0039, Test Loss: 0.3146, F1: 0.4800, AUC: 0.8678
Epoch [20/30] Train Loss: 0.0012, Test Loss: 0.3950, F1: 0.4854, AUC: 0.8640
Mejores resultados en la época:  0
f1-score 0.5567765567765568
AUC según el mejor F1-score 0.911814253277668
Confusion Matrix:
 [[1267   86]
 [  35   76]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9173
Precision:  0.4691
Recall:     0.6847
F1-score:   0.5568

--- Iteración 4 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3927, Test Loss: 0.2414, F1: 0.5540, AUC: 0.9121
Epoch [10/30] Train Loss: 0.0052, Test Loss: 0.3137, F1: 0.4747, AUC: 0.8777
Epoch [20/30] Train Loss: 0.0015, Test Loss: 0.3931, F1: 0.4689, AUC: 0.8749
Mejores resultados en la época:  1
f1-score 0.5702479338842975
AUC según el mejor F1-score 0.9060080035689793
Confusion Matrix:
 [[1291   62]
 [  42   69]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9290
Precision:  0.5267
Recall:     0.6216
F1-score:   0.5702
Tiempo total para red 1: 83.80 segundos

Entrenando red 2 con capas [5000, 64, 32, 1]

--- Iteración 1 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2952, Test Loss: 0.2072, F1: 0.5487, AUC: 0.8811
Epoch [10/30] Train Loss: 0.0012, Test Loss: 0.4592, F1: 0.4664, AUC: 0.8526
Epoch [20/30] Train Loss: 0.0008, Test Loss: 0.5204, F1: 0.4532, AUC: 0.8469
Mejores resultados en la época:  0
f1-score 0.5486725663716814
AUC según el mejor F1-score 0.8810717591205397
Confusion Matrix:
 [[1300   53]
 [  49   62]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9303
Precision:  0.5391
Recall:     0.5586
F1-score:   0.5487

--- Iteración 2 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2836, Test Loss: 0.2008, F1: 0.5340, AUC: 0.8954
Epoch [10/30] Train Loss: 0.0009, Test Loss: 0.5006, F1: 0.4600, AUC: 0.8602
Epoch [20/30] Train Loss: 0.0003, Test Loss: 0.5918, F1: 0.4545, AUC: 0.8584
Mejores resultados en la época:  0
f1-score 0.5339805825242718
AUC según el mejor F1-score 0.8953942856381881
Confusion Matrix:
 [[1313   40]
 [  56   55]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9344
Precision:  0.5789
Recall:     0.4955
F1-score:   0.5340

--- Iteración 3 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.3073, Test Loss: 0.1942, F1: 0.5780, AUC: 0.8971
Epoch [10/30] Train Loss: 0.0004, Test Loss: 0.4706, F1: 0.4577, AUC: 0.8550
Epoch [20/30] Train Loss: 0.0015, Test Loss: 0.5559, F1: 0.4664, AUC: 0.8518
Mejores resultados en la época:  0
f1-score 0.5779816513761468
AUC según el mejor F1-score 0.8971388239680923
Confusion Matrix:
 [[1309   44]
 [  48   63]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9372
Precision:  0.5888
Recall:     0.5676
F1-score:   0.5780

--- Iteración 4 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2708, Test Loss: 0.2088, F1: 0.5411, AUC: 0.8937
Epoch [10/30] Train Loss: 0.0006, Test Loss: 0.4999, F1: 0.4817, AUC: 0.8616
Epoch [20/30] Train Loss: 0.0003, Test Loss: 0.5837, F1: 0.4821, AUC: 0.8615
Mejores resultados en la época:  0
f1-score 0.5410628019323671
AUC según el mejor F1-score 0.8937030156542352
Confusion Matrix:
 [[1313   40]
 [  55   56]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9351
Precision:  0.5833
Recall:     0.5045
F1-score:   0.5411
Tiempo total para red 2: 88.79 segundos

Entrenando red 3 con capas [5000, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2257, Test Loss: 0.2795, F1: 0.4972, AUC: 0.8728
Epoch [10/30] Train Loss: 0.0005, Test Loss: 0.9169, F1: 0.4528, AUC: 0.8512
Epoch [20/30] Train Loss: 0.0003, Test Loss: 1.2473, F1: 0.4433, AUC: 0.8466
Mejores resultados en la época:  0
f1-score 0.4972375690607735
AUC según el mejor F1-score 0.8728085069548485
Confusion Matrix:
 [[1328   25]
 [  66   45]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9378
Precision:  0.6429
Recall:     0.4054
F1-score:   0.4972

--- Iteración 2 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2392, Test Loss: 0.3229, F1: 0.4268, AUC: 0.8568
Epoch [10/30] Train Loss: 0.0007, Test Loss: 0.6458, F1: 0.4688, AUC: 0.8459
Epoch [20/30] Train Loss: 0.0002, Test Loss: 0.8000, F1: 0.4700, AUC: 0.8429
Mejores resultados en la época:  28
f1-score 0.4873096446700508
AUC según el mejor F1-score 0.8434776239654289
Confusion Matrix:
 [[1315   38]
 [  63   48]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9310
Precision:  0.5581
Recall:     0.4324
F1-score:   0.4873

--- Iteración 3 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2328, Test Loss: 0.2786, F1: 0.5474, AUC: 0.8734
Epoch [10/30] Train Loss: 0.0005, Test Loss: 0.8217, F1: 0.4663, AUC: 0.8423
Epoch [20/30] Train Loss: 0.0004, Test Loss: 1.0134, F1: 0.4623, AUC: 0.8468
Mejores resultados en la época:  0
f1-score 0.5473684210526316
AUC según el mejor F1-score 0.8733545075008489
Confusion Matrix:
 [[1326   27]
 [  59   52]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9413
Precision:  0.6582
Recall:     0.4685
F1-score:   0.5474

--- Iteración 4 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2230, Test Loss: 0.2825, F1: 0.4419, AUC: 0.8461
Epoch [10/30] Train Loss: 0.0007, Test Loss: 0.5308, F1: 0.4467, AUC: 0.8547
Epoch [20/30] Train Loss: 0.0002, Test Loss: 0.6709, F1: 0.4339, AUC: 0.8536
Mejores resultados en la época:  2
f1-score 0.4623115577889447
AUC según el mejor F1-score 0.8553031967666116
Confusion Matrix:
 [[1311   42]
 [  65   46]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9269
Precision:  0.5227
Recall:     0.4144
F1-score:   0.4623
Tiempo total para red 3: 117.53 segundos

Entrenando red 4 con capas [5000, 256, 128, 64, 32, 1]

For TF-IDF embbedings you are selecteing this columns:
--> ['lyrics']
Your are not adding cols numercis
You are executing with [ALL] dataset
--> PaTH:  ../../../../../data/spanish/LB_T/LB_fuss/lb_khipu_T.npy

##################################################
Running experiment with TFIDF embeddings
Preprocessing text...
Label distribution: {False: 6765, True: 554}

Data con el spliting...
Label distribution en TRAIN: {0: 5412, 1: 443}
Label distribution en TEST: {0: 1353, 1: 111}




Aplicando SMOTE oversampling...
Nueva distribución de clases: {0: 5412, 1: 5412}
Resultados con MLP

Entrenando red 1 con capas [5000, 32, 1]

--- Iteración 1 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3928, Test Loss: 0.2535, F1: 0.5512, AUC: 0.9116
Epoch [10/30] Train Loss: 0.0039, Test Loss: 0.3105, F1: 0.4824, AUC: 0.8736
Epoch [20/30] Train Loss: 0.0012, Test Loss: 0.3933, F1: 0.4780, AUC: 0.8695
Mejores resultados en la época:  1
f1-score 0.563265306122449
AUC según el mejor F1-score 0.9050358562553684
Confusion Matrix:
 [[1288   65]
 [  42   69]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9269
Precision:  0.5149
Recall:     0.6216
F1-score:   0.5633

--- Iteración 2 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3874, Test Loss: 0.2530, F1: 0.5404, AUC: 0.9139
Epoch [10/30] Train Loss: 0.0042, Test Loss: 0.3122, F1: 0.4880, AUC: 0.8778
Epoch [20/30] Train Loss: 0.0015, Test Loss: 0.3935, F1: 0.4739, AUC: 0.8743
Mejores resultados en la época:  1
f1-score 0.5630252100840336
AUC según el mejor F1-score 0.9055618811716373
Confusion Matrix:
 [[1293   60]
 [  44   67]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9290
Precision:  0.5276
Recall:     0.6036
F1-score:   0.5630

--- Iteración 3 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3903, Test Loss: 0.2681, F1: 0.5498, AUC: 0.9128
Epoch [10/30] Train Loss: 0.0039, Test Loss: 0.3125, F1: 0.4776, AUC: 0.8685
Epoch [20/30] Train Loss: 0.0010, Test Loss: 0.3949, F1: 0.4880, AUC: 0.8643
Mejores resultados en la época:  1
f1-score 0.5691056910569106
AUC según el mejor F1-score 0.9041036602012211
Confusion Matrix:
 [[1288   65]
 [  41   70]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9276
Precision:  0.5185
Recall:     0.6306
F1-score:   0.5691

--- Iteración 4 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.3986, Test Loss: 0.2542, F1: 0.5409, AUC: 0.9106
Epoch [10/30] Train Loss: 0.0040, Test Loss: 0.3131, F1: 0.4724, AUC: 0.8698
Epoch [20/30] Train Loss: 0.0013, Test Loss: 0.3969, F1: 0.4776, AUC: 0.8662
Mejores resultados en la época:  1
f1-score 0.5542168674698795
AUC según el mejor F1-score 0.9052489296391736
Confusion Matrix:
 [[1284   69]
 [  42   69]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_160065.png
Accuracy:   0.9242
Precision:  0.5000
Recall:     0.6216
F1-score:   0.5542
Tiempo total para red 1: 84.32 segundos

Entrenando red 2 con capas [5000, 64, 32, 1]

--- Iteración 1 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2689, Test Loss: 0.2136, F1: 0.5727, AUC: 0.8980
Epoch [10/30] Train Loss: 0.0010, Test Loss: 0.4764, F1: 0.4762, AUC: 0.8663
Epoch [20/30] Train Loss: 0.0002, Test Loss: 0.5529, F1: 0.4729, AUC: 0.8598
Mejores resultados en la época:  0
f1-score 0.5727272727272728
AUC según el mejor F1-score 0.8979578247870931
Confusion Matrix:
 [[1307   46]
 [  48   63]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9358
Precision:  0.5780
Recall:     0.5676
F1-score:   0.5727

--- Iteración 2 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2817, Test Loss: 0.2004, F1: 0.5500, AUC: 0.8864
Epoch [10/30] Train Loss: 0.0008, Test Loss: 0.5018, F1: 0.4688, AUC: 0.8486
Epoch [20/30] Train Loss: 0.0003, Test Loss: 0.7547, F1: 0.4583, AUC: 0.8545
Mejores resultados en la época:  0
f1-score 0.55
AUC según el mejor F1-score 0.8864119108021546
Confusion Matrix:
 [[1319   34]
 [  56   55]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9385
Precision:  0.6180
Recall:     0.4955
F1-score:   0.5500

--- Iteración 3 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.2987, Test Loss: 0.2098, F1: 0.5586, AUC: 0.8988
Epoch [10/30] Train Loss: 0.0053, Test Loss: 0.4787, F1: 0.4592, AUC: 0.8602
Epoch [20/30] Train Loss: 0.0004, Test Loss: 0.5881, F1: 0.4500, AUC: 0.8585
Mejores resultados en la época:  0
f1-score 0.5585585585585585
AUC según el mejor F1-score 0.8988034597790695
Confusion Matrix:
 [[1304   49]
 [  49   62]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9331
Precision:  0.5586
Recall:     0.5586
F1-score:   0.5586

--- Iteración 4 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.3077, Test Loss: 0.1942, F1: 0.5294, AUC: 0.8832
Epoch [10/30] Train Loss: 0.0010, Test Loss: 0.4335, F1: 0.4800, AUC: 0.8545
Epoch [20/30] Train Loss: 0.0007, Test Loss: 0.5234, F1: 0.4851, AUC: 0.8552
Mejores resultados en la época:  0
f1-score 0.5294117647058824
AUC según el mejor F1-score 0.8832158100450783
Confusion Matrix:
 [[1314   39]
 [  57   54]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_322177.png
Accuracy:   0.9344
Precision:  0.5806
Recall:     0.4865
F1-score:   0.5294
Tiempo total para red 2: 89.93 segundos

Entrenando red 3 con capas [5000, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2371, Test Loss: 0.2562, F1: 0.5025, AUC: 0.8644
Epoch [10/30] Train Loss: 0.0008, Test Loss: 0.5668, F1: 0.4813, AUC: 0.8450
Epoch [20/30] Train Loss: 0.0003, Test Loss: 0.8598, F1: 0.4787, AUC: 0.8479
Mejores resultados en la época:  0
f1-score 0.5025125628140703
AUC según el mejor F1-score 0.8643588155783279
Confusion Matrix:
 [[1315   38]
 [  61   50]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9324
Precision:  0.5682
Recall:     0.4505
F1-score:   0.5025

--- Iteración 2 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2275, Test Loss: 0.3076, F1: 0.4737, AUC: 0.8560
Epoch [10/30] Train Loss: 0.0005, Test Loss: 0.9620, F1: 0.4653, AUC: 0.8588
Epoch [20/30] Train Loss: 0.0012, Test Loss: 1.1764, F1: 0.4638, AUC: 0.8592
Mejores resultados en la época:  8
f1-score 0.4787234042553192
AUC según el mejor F1-score 0.8565583321680882
Confusion Matrix:
 [[1321   32]
 [  66   45]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9331
Precision:  0.5844
Recall:     0.4054
F1-score:   0.4787

--- Iteración 3 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2325, Test Loss: 0.2568, F1: 0.4976, AUC: 0.8781
Epoch [10/30] Train Loss: 0.0006, Test Loss: 0.6753, F1: 0.4878, AUC: 0.8660
Epoch [20/30] Train Loss: 0.0003, Test Loss: 0.8142, F1: 0.4878, AUC: 0.8613
Mejores resultados en la época:  6
f1-score 0.5
AUC según el mejor F1-score 0.8702949068802728
Confusion Matrix:
 [[1296   57]
 [  55   56]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9235
Precision:  0.4956
Recall:     0.5045
F1-score:   0.5000

--- Iteración 4 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.2301, Test Loss: 0.2945, F1: 0.4916, AUC: 0.8486
Epoch [10/30] Train Loss: 0.0003, Test Loss: 0.7047, F1: 0.4398, AUC: 0.8471
Epoch [20/30] Train Loss: 0.0003, Test Loss: 1.0253, F1: 0.4066, AUC: 0.8474
Mejores resultados en la época:  0
f1-score 0.49162011173184356
AUC según el mejor F1-score 0.8485980437199949
Confusion Matrix:
 [[1329   24]
 [  67   44]]
Matriz de confusión guardada en: outputs_only_text_pseudo/2/tfidf/confusion_matrix_param_650497.png
Accuracy:   0.9378
Precision:  0.6471
Recall:     0.3964
F1-score:   0.4916
Tiempo total para red 3: 120.17 segundos

Entrenando red 4 con capas [5000, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 4 ---
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd-g001: error: *** STEP 17527.0 ON g001 CANCELLED AT 2025-10-30T04:25:57 ***
slurmstepd-g001: error: *** JOB 17527 ON g001 CANCELLED AT 2025-10-30T04:25:57 ***
