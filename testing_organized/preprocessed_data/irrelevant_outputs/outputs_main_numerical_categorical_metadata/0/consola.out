2025-09-30 23:40:44.232514: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/marcelino.maita/musica_ia_workshop/models_comparison/testing_organized/preprocessed_data/main_numerical_categorical_metadata.py:281: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda grp: grp.sample(n=n_min, random_state=RANDOM_STATE))
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
CAT_LOW 3 ['emotion', 'Key', 'Time signature']
CAT_HIGH 14 ['Artist(s)', 'song', 'Length', 'Genre', 'Album', 'Loudness (db)', 'Similar Artist 1', 'Similar Song 1', 'Similar Artist 2', 'Similar Song 2', 'Similar Artist 3', 'Similar Song 3', 'song_normalized', 'artist_normalized']
For TF-IDF embbedings you are selecteing this columns:
--> ['text']
For both embbedings your are adding this columns: 
--> ['Release Date', 'Tempo', 'Length', 'Loudness (db)', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine']
You are executing with [ALL] dataset
--> PaTH:  ../../data/new_embbedings_khipu/LB_fuss/lb_khipu_T.npy
Contaning the categorical cols
Nuevas dimensiones X con categóricas: (108125, 2085)
Tamanio:  (108125, 43)
Total de columnas:  43
Columnas numericas usadas:  ['Tempo', 'Length', 'Loudness (db)', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Release_Year', 'Release_Month', 'Release_Day']
Columnas del df:  ['Artist(s)', 'song', 'text', 'Length', 'emotion', 'Genre', 'Album', 'Key', 'Tempo', 'Loudness (db)', 'Time signature', 'Explicit', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Similar Artist 1', 'Similar Song 1', 'Similarity Score 1', 'Similar Artist 2', 'Similar Song 2', 'Similarity Score 2', 'Similar Artist 3', 'Similar Song 3', 'Similarity Score 3', 'song_normalized', 'artist_normalized', 'Release_Year', 'Release_Month', 'Release_Day']
<class 'numpy.ndarray'> <class 'pandas.core.series.Series'>
(108125, 2131)
(108125,)

Splitting data...

Data con el spliting...
Label distribution en TRAIN: {0: 65861, 1: 20639}
Label distribution en TEST: {0: 16465, 1: 5160}


==================================================
Data antes del undersampling ...
X: (86500, 2131)
y: (86500,)
Apliying UNDERSAMPLE
20639
Label distribution: {0: 20639, 1: 20639}
X shape: (41278, 2131)
y shape: (41278,)
Resultados con MLP

Entrenando red 1 con capas [2131, 32, 1]

--- Iteración 1 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6935, Test Loss: 0.6914, F1: 0.0000, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6918, F1: 0.0000, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6948, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  2
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 2 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6932, Test Loss: 0.6933, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6913, F1: 0.0000, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6937, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6324, Test Loss: 0.5923, F1: 0.5532, AUC: 0.8138
Epoch [10/30] Train Loss: 0.4341, Test Loss: 0.3642, F1: 0.7038, AUC: 0.8926
Epoch [20/30] Train Loss: 0.4120, Test Loss: 0.3320, F1: 0.6433, AUC: 0.9021
Mejores resultados en la época:  28
f1-score 0.725316216726449
AUC según el mejor F1-score 0.9077974067613471
Confusion Matrix:
 [[14873  1592]
 [ 1318  3842]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_68257.png
Accuracy:   0.8654
Precision:  0.7070
Recall:     0.7446
F1-score:   0.7253

--- Iteración 4 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6938, Test Loss: 0.6947, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6922, F1: 0.0000, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6916, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853
Tiempo total para red 1: 242.18 segundos

Entrenando red 2 con capas [2131, 64, 32, 1]

--- Iteración 1 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6450, Test Loss: 0.4785, F1: 0.5583, AUC: 0.8112
Epoch [10/30] Train Loss: 0.4343, Test Loss: 0.3680, F1: 0.7019, AUC: 0.8928
Epoch [20/30] Train Loss: 0.4144, Test Loss: 0.4270, F1: 0.6843, AUC: 0.9022
Mejores resultados en la época:  27
f1-score 0.7206337643416499
AUC según el mejor F1-score 0.9075631831204082
Confusion Matrix:
 [[14600  1865]
 [ 1203  3957]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_138561.png
Accuracy:   0.8581
Precision:  0.6797
Recall:     0.7669
F1-score:   0.7206

--- Iteración 2 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6324, Test Loss: 0.4654, F1: 0.5866, AUC: 0.8254
Epoch [10/30] Train Loss: 0.4329, Test Loss: 0.4907, F1: 0.6521, AUC: 0.8943
Epoch [20/30] Train Loss: 0.4064, Test Loss: 0.3964, F1: 0.6969, AUC: 0.9038
Mejores resultados en la época:  25
f1-score 0.7209638554216867
AUC según el mejor F1-score 0.9057976633544963
Confusion Matrix:
 [[14990  1475]
 [ 1420  3740]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_138561.png
Accuracy:   0.8661
Precision:  0.7172
Recall:     0.7248
F1-score:   0.7210

--- Iteración 3 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6507, Test Loss: 0.7333, F1: 0.4723, AUC: 0.8089
Epoch [10/30] Train Loss: 0.4308, Test Loss: 0.3684, F1: 0.7035, AUC: 0.8921
Epoch [20/30] Train Loss: 0.4159, Test Loss: 0.5666, F1: 0.6155, AUC: 0.9013
Mejores resultados en la época:  28
f1-score 0.7213267492779278
AUC según el mejor F1-score 0.9071900342987357
Confusion Matrix:
 [[14763  1702]
 [ 1289  3871]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_138561.png
Accuracy:   0.8617
Precision:  0.6946
Recall:     0.7502
F1-score:   0.7213

--- Iteración 4 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6492, Test Loss: 0.6581, F1: 0.5123, AUC: 0.8041
Epoch [10/30] Train Loss: 0.4319, Test Loss: 0.3684, F1: 0.7032, AUC: 0.8929
Epoch [20/30] Train Loss: 0.4079, Test Loss: 0.3841, F1: 0.6983, AUC: 0.9025
Mejores resultados en la época:  27
f1-score 0.7205503009458297
AUC según el mejor F1-score 0.9064713910408972
Confusion Matrix:
 [[14929  1536]
 [ 1389  3771]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_138561.png
Accuracy:   0.8647
Precision:  0.7106
Recall:     0.7308
F1-score:   0.7206
Tiempo total para red 2: 256.43 segundos

Entrenando red 3 con capas [2131, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6291, Test Loss: 0.5283, F1: 0.6010, AUC: 0.8341
Epoch [10/30] Train Loss: 0.4340, Test Loss: 0.4726, F1: 0.6671, AUC: 0.8929
Epoch [20/30] Train Loss: 0.4092, Test Loss: 0.3372, F1: 0.7178, AUC: 0.9037
Mejores resultados en la época:  25
f1-score 0.7225983711117653
AUC según el mejor F1-score 0.9066417135714235
Confusion Matrix:
 [[15116  1349]
 [ 1478  3682]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_283265.png
Accuracy:   0.8693
Precision:  0.7319
Recall:     0.7136
F1-score:   0.7226

--- Iteración 2 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6278, Test Loss: 0.5066, F1: 0.6043, AUC: 0.8365
Epoch [10/30] Train Loss: 0.4325, Test Loss: 0.4425, F1: 0.6779, AUC: 0.8937
Epoch [20/30] Train Loss: 0.4086, Test Loss: 0.4026, F1: 0.6988, AUC: 0.9027
Mejores resultados en la época:  27
f1-score 0.7261502845567667
AUC según el mejor F1-score 0.9084800210453464
Confusion Matrix:
 [[15022  1443]
 [ 1396  3764]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_283265.png
Accuracy:   0.8687
Precision:  0.7229
Recall:     0.7295
F1-score:   0.7262

--- Iteración 3 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6746, Test Loss: 0.6252, F1: 0.5262, AUC: 0.7867
Epoch [10/30] Train Loss: 0.4325, Test Loss: 0.3926, F1: 0.6974, AUC: 0.8924
Epoch [20/30] Train Loss: 0.4085, Test Loss: 0.3258, F1: 0.7068, AUC: 0.9019
Mejores resultados en la época:  23
f1-score 0.717948717948718
AUC según el mejor F1-score 0.9040116043663209
Confusion Matrix:
 [[14825  1640]
 [ 1352  3808]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_283265.png
Accuracy:   0.8616
Precision:  0.6990
Recall:     0.7380
F1-score:   0.7179

--- Iteración 4 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6165, Test Loss: 0.4051, F1: 0.5961, AUC: 0.8432
Epoch [10/30] Train Loss: 0.4354, Test Loss: 0.5956, F1: 0.6056, AUC: 0.8955
Epoch [20/30] Train Loss: 0.4166, Test Loss: 0.4604, F1: 0.6781, AUC: 0.9026
Mejores resultados en la época:  28
f1-score 0.7236804967541631
AUC según el mejor F1-score 0.9083947803303694
Confusion Matrix:
 [[14842  1623]
 [ 1314  3846]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_283265.png
Accuracy:   0.8642
Precision:  0.7032
Recall:     0.7453
F1-score:   0.7237
Tiempo total para red 3: 270.39 segundos

Entrenando red 4 con capas [2131, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6287, Test Loss: 0.5233, F1: 0.5966, AUC: 0.8330
Epoch [10/30] Train Loss: 0.4366, Test Loss: 0.5064, F1: 0.6424, AUC: 0.8943
Epoch [20/30] Train Loss: 0.4054, Test Loss: 0.6006, F1: 0.5980, AUC: 0.9036
Mejores resultados en la época:  25
f1-score 0.717565074810412
AUC según el mejor F1-score 0.9045562586364783
Confusion Matrix:
 [[15368  1097]
 [ 1659  3501]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_589057.png
Accuracy:   0.8726
Precision:  0.7614
Recall:     0.6785
F1-score:   0.7176

--- Iteración 2 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6342, Test Loss: 0.4542, F1: 0.6041, AUC: 0.8343
Epoch [10/30] Train Loss: 0.4303, Test Loss: 0.4582, F1: 0.6667, AUC: 0.8945
Epoch [20/30] Train Loss: 0.4168, Test Loss: 0.3658, F1: 0.7191, AUC: 0.9035
Mejores resultados en la época:  26
f1-score 0.7264677574590953
AUC según el mejor F1-score 0.9080668236828415
Confusion Matrix:
 [[15009  1456]
 [ 1386  3774]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_589057.png
Accuracy:   0.8686
Precision:  0.7216
Recall:     0.7314
F1-score:   0.7265

--- Iteración 3 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6215, Test Loss: 0.5891, F1: 0.5685, AUC: 0.8426
Epoch [10/30] Train Loss: 0.4375, Test Loss: 0.3620, F1: 0.6931, AUC: 0.8951
Epoch [20/30] Train Loss: 0.4171, Test Loss: 0.4334, F1: 0.6807, AUC: 0.9023
Mejores resultados en la época:  25
f1-score 0.7200321802091714
AUC según el mejor F1-score 0.9058106107152357
Confusion Matrix:
 [[15261  1204]
 [ 1580  3580]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_589057.png
Accuracy:   0.8713
Precision:  0.7483
Recall:     0.6938
F1-score:   0.7200

--- Iteración 4 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6293, Test Loss: 0.6054, F1: 0.5568, AUC: 0.8327
Epoch [10/30] Train Loss: 0.4287, Test Loss: 0.3930, F1: 0.7010, AUC: 0.8944
Epoch [20/30] Train Loss: 0.4139, Test Loss: 0.5925, F1: 0.6191, AUC: 0.9023
Mejores resultados en la época:  28
f1-score 0.7213476940071804
AUC según el mejor F1-score 0.9091865879467135
Confusion Matrix:
 [[14680  1785]
 [ 1242  3918]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_589057.png
Accuracy:   0.8600
Precision:  0.6870
Recall:     0.7593
F1-score:   0.7213
Tiempo total para red 4: 285.88 segundos

Entrenando red 5 con capas [2131, 512, 256, 128, 64, 1]

--- Iteración 1 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6097, Test Loss: 0.4507, F1: 0.6312, AUC: 0.8498
Epoch [10/30] Train Loss: 0.4450, Test Loss: 0.6083, F1: 0.5991, AUC: 0.8921
Epoch [20/30] Train Loss: 0.4243, Test Loss: 0.3487, F1: 0.7066, AUC: 0.9023
Mejores resultados en la época:  28
f1-score 0.7169924812030075
AUC según el mejor F1-score 0.9070826771375503
Confusion Matrix:
 [[15226  1239]
 [ 1584  3576]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_1264129.png
Accuracy:   0.8695
Precision:  0.7427
Recall:     0.6930
F1-score:   0.7170

--- Iteración 2 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6202, Test Loss: 0.5486, F1: 0.5919, AUC: 0.8427
Epoch [10/30] Train Loss: 0.4314, Test Loss: 0.4709, F1: 0.6611, AUC: 0.8949
Epoch [20/30] Train Loss: 0.4153, Test Loss: 0.4463, F1: 0.6774, AUC: 0.9007
Mejores resultados en la época:  28
f1-score 0.7188488621287886
AUC según el mejor F1-score 0.9053052634552503
Confusion Matrix:
 [[15348  1117]
 [ 1638  3522]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_1264129.png
Accuracy:   0.8726
Precision:  0.7592
Recall:     0.6826
F1-score:   0.7188

--- Iteración 3 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6101, Test Loss: 0.4468, F1: 0.6239, AUC: 0.8456
Epoch [10/30] Train Loss: 0.4347, Test Loss: 0.4924, F1: 0.6580, AUC: 0.8945
Epoch [20/30] Train Loss: 0.4139, Test Loss: 0.4022, F1: 0.7021, AUC: 0.9042
Mejores resultados en la época:  25
f1-score 0.7244636882503445
AUC según el mejor F1-score 0.9075348695965366
Confusion Matrix:
 [[15144  1321]
 [ 1479  3681]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_1264129.png
Accuracy:   0.8705
Precision:  0.7359
Recall:     0.7134
F1-score:   0.7245

--- Iteración 4 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6289, Test Loss: 0.6049, F1: 0.5652, AUC: 0.8371
Epoch [10/30] Train Loss: 0.4399, Test Loss: 0.4203, F1: 0.6921, AUC: 0.8928
Epoch [20/30] Train Loss: 0.4119, Test Loss: 0.4763, F1: 0.6658, AUC: 0.9019
Mejores resultados en la época:  29
f1-score 0.7232820892757919
AUC según el mejor F1-score 0.9071259684037317
Confusion Matrix:
 [[14732  1733]
 [ 1255  3905]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_1264129.png
Accuracy:   0.8618
Precision:  0.6926
Recall:     0.7568
F1-score:   0.7233
Tiempo total para red 5: 291.22 segundos

Entrenando red 6 con capas [2131, 1024, 512, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6921, Test Loss: 0.6902, F1: 0.1788, AUC: 0.7485
Epoch [10/30] Train Loss: 0.4358, Test Loss: 0.3853, F1: 0.6958, AUC: 0.8921
Epoch [20/30] Train Loss: 0.4193, Test Loss: 0.3291, F1: 0.6796, AUC: 0.9002
Mejores resultados en la época:  27
f1-score 0.7180616740088106
AUC según el mejor F1-score 0.9049996998566374
Confusion Matrix:
 [[15223  1242]
 [ 1574  3586]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_2882561.png
Accuracy:   0.8698
Precision:  0.7428
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/svm/_base.py:305: ConvergenceWarning: Solver terminated early (max_iter=1000).  Consider pre-processing your data with StandardScaler or MinMaxScaler.
  warnings.warn(
/home/marcelino.maita/.venv/lib/python3.13/site-packages/xgboost/training.py:183: UserWarning: [00:12:02] WARNING: /workspace/src/learner.cc:738: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
Recall:     0.6950
F1-score:   0.7181

--- Iteración 2 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6934, Test Loss: 0.6932, F1: 0.3853, AUC: 0.4999
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6960, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6964, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.49990310666035775
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_2882561.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6725, Test Loss: 0.8085, F1: 0.4345, AUC: 0.8089
Epoch [10/30] Train Loss: 0.4382, Test Loss: 0.6195, F1: 0.6000, AUC: 0.8926
Epoch [20/30] Train Loss: 0.4201, Test Loss: 0.3543, F1: 0.7107, AUC: 0.9009
Mejores resultados en la época:  27
f1-score 0.7207156308851224
AUC según el mejor F1-score 0.905191744527386
Confusion Matrix:
 [[14832  1633]
 [ 1333  3827]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_2882561.png
Accuracy:   0.8628
Precision:  0.7009
Recall:     0.7417
F1-score:   0.7207

--- Iteración 4 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6338, Test Loss: 0.4981, F1: 0.6132, AUC: 0.8380
Epoch [10/30] Train Loss: 0.4372, Test Loss: 0.3678, F1: 0.7037, AUC: 0.8931
Epoch [20/30] Train Loss: 0.4208, Test Loss: 0.3935, F1: 0.7078, AUC: 0.9002
Mejores resultados en la época:  24
f1-score 0.7184094819346205
AUC según el mejor F1-score 0.9025327685929985
Confusion Matrix:
 [[14921  1544]
 [ 1402  3758]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/tfidf/confusion_matrix_param_2882561.png
Accuracy:   0.8638
Precision:  0.7088
Recall:     0.7283
F1-score:   0.7184
Tiempo total para red 6: 324.10 segundos
Saved on: outputs_main_numerical_categorical_metadata/0/tfidf

==============================
Model: Logistic Regression
Accuracy:  0.8447
Precision: 0.6332
Recall:    0.8300
F1-score:  0.7184
              precision    recall  f1-score   support

           0       0.94      0.85      0.89     16465
           1       0.63      0.83      0.72      5160

    accuracy                           0.84     21625
   macro avg       0.79      0.84      0.81     21625
weighted avg       0.87      0.84      0.85     21625

[[13984  2481]
 [  877  4283]]
Hiperparámetros: {'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 1000, 'multi_class': 'deprecated', 'n_jobs': None, 'penalty': 'l2', 'random_state': 42, 'solver': 'lbfgs', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_logistic_regression.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/logistic_regression_model.pkl

==============================
Model: SVM
Accuracy:  0.3950
Precision: 0.2573
Recall:    0.8138
F1-score:  0.3910
              precision    recall  f1-score   support

           0       0.82      0.26      0.40     16465
           1       0.26      0.81      0.39      5160

    accuracy                           0.40     21625
   macro avg       0.54      0.54      0.39     21625
weighted avg       0.68      0.40      0.40     21625

[[ 4343 12122]
 [  961  4199]]
Hiperparámetros: {'C': 1.0, 'break_ties': False, 'cache_size': 200, 'class_weight': None, 'coef0': 0.0, 'decision_function_shape': 'ovr', 'degree': 3, 'gamma': 'scale', 'kernel': 'rbf', 'max_iter': 1000, 'probability': False, 'random_state': 42, 'shrinking': True, 'tol': 0.001, 'verbose': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_svm.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/svm_model.pkl

==============================
Model: Decision Tree
Accuracy:  0.8345
Precision: 0.6212
Recall:    0.7851
F1-score:  0.6936
              precision    recall  f1-score   support

           0       0.93      0.85      0.89     16465
           1       0.62      0.79      0.69      5160

    accuracy                           0.83     21625
   macro avg       0.77      0.82      0.79     21625
weighted avg       0.85      0.83      0.84     21625

[[13995  2470]
 [ 1109  4051]]
Hiperparámetros: {'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'entropy', 'max_depth': 10, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'random_state': 42, 'splitter': 'best'}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_decision_tree.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/decision_tree_model.pkl

==============================
Model: Random Forest
Accuracy:  0.8601
Precision: 0.6724
Recall:    0.8070
F1-score:  0.7336
              precision    recall  f1-score   support

           0       0.94      0.88      0.91     16465
           1       0.67      0.81      0.73      5160

    accuracy                           0.86     21625
   macro avg       0.80      0.84      0.82     21625
weighted avg       0.87      0.86      0.86     21625

[[14436  2029]
 [  996  4164]]
Hiperparámetros: {'bootstrap': True, 'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'gini', 'max_depth': 15, 'max_features': 'sqrt', 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'n_estimators': 200, 'n_jobs': -1, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_random_forest.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/random_forest_model.pkl

==============================
Model: XGBoost
Accuracy:  0.8822
Precision: 0.7128
Recall:    0.8479
F1-score:  0.7745
              precision    recall  f1-score   support

           0       0.95      0.89      0.92     16465
           1       0.71      0.85      0.77      5160

    accuracy                           0.88     21625
   macro avg       0.83      0.87      0.85     21625
weighted avg       0.89      0.88      0.89     21625

[[14702  1763]
 [  785  4375]]
Hiperparámetros: {'objective': 'binary:logistic', 'base_score': None, 'booster': None, 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.8, 'device': None, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'logloss', 'feature_types': None, 'feature_weights': None, 'gamma': None, 'grow_policy': None, 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.1, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 8, 'max_leaves': None, 'min_child_weight': None, 'missing': nan, 'monotone_constraints': None, 'multi_strategy': None, 'n_estimators': 200, 'n_jobs': None, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': None, 'reg_lambda': None, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': 0.8, 'tree_method': None, 'validate_parameters': None, 'verbosity': None, 'use_label_encoder': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_xgboost.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/xgboost_model.pkl

==============================
Model: Naive Bayes
Accuracy:  0.6766
Precision: 0.4009
Recall:    0.7188
F1-score:  0.5147
              precision    recall  f1-score   support

           0       0.88      0.66      0.76     16465
           1       0.40      0.72      0.51      5160

    accuracy                           0.68     21625
   macro avg       0.64      0.69      0.64     21625
weighted avg       0.77      0.68      0.70     21625
/home/marcelino.maita/musica_ia_workshop/models_comparison/testing_organized/preprocessed_data/main_numerical_categorical_metadata.py:281: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda grp: grp.sample(n=n_min, random_state=RANDOM_STATE))
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])

[[10923  5542]
 [ 1451  3709]]
Hiperparámetros: {'alpha': 1.0, 'class_prior': None, 'fit_prior': True, 'force_alpha': True}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/tfidf/conf_matrix_naive_bayes.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/tfidf/naive_bayes_model.pkl


Resumen de métricas:
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.6766, 'precision': 0.4009, 'recall': 0.7188, 'f1_score': 0.5147}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}
Contaning the categorical cols
Nuevas dimensiones X con categóricas: (108125, 2085)
Tamanio:  (108125, 43)
Total de columnas:  43
Columnas numericas usadas:  ['Tempo', 'Length', 'Loudness (db)', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Release_Year', 'Release_Month', 'Release_Day']
Columnas del df:  ['Artist(s)', 'song', 'text', 'Length', 'emotion', 'Genre', 'Album', 'Key', 'Tempo', 'Loudness (db)', 'Time signature', 'Explicit', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Similar Artist 1', 'Similar Song 1', 'Similarity Score 1', 'Similar Artist 2', 'Similar Song 2', 'Similarity Score 2', 'Similar Artist 3', 'Similar Song 3', 'Similarity Score 3', 'song_normalized', 'artist_normalized', 'Release_Year', 'Release_Month', 'Release_Day']
<class 'numpy.ndarray'> <class 'pandas.core.series.Series'>
(108125, 2131)
(108125,)

Splitting data...

Data con el spliting...
Label distribution en TRAIN: {0: 65861, 1: 20639}
Label distribution en TEST: {0: 16465, 1: 5160}


==================================================
Data antes del undersampling ...
X: (86500, 2131)
y: (86500,)
Apliying UNDERSAMPLE
20639
Label distribution: {0: 20639, 1: 20639}
X shape: (41278, 2131)
y shape: (41278,)
Resultados con MLP

Entrenando red 1 con capas [2131, 32, 1]

--- Iteración 1 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6939, Test Loss: 0.6982, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6970, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6949, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 2 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6943, Test Loss: 0.6965, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6929, F1: 0.0000, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6942, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.4999696325539022
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6942, Test Loss: 0.6976, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6968, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6923, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 4 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6935, Test Loss: 0.6902, F1: 0.0000, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6944, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6915, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  1
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853
Tiempo total para red 1: 251.74 segundos

Entrenando red 2 con capas [2131, 64, 32, 1]

--- Iteración 1 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6448, Test Loss: 0.4428, F1: 0.4888, AUC: 0.8130
Epoch [10/30] Train Loss: 0.4312, Test Loss: 0.3810, F1: 0.7017, AUC: 0.8931
Epoch [20/30] Train Loss: 0.4103, Test Loss: 0.3681, F1: 0.7111, AUC: 0.9025
Mejores resultados en la época:  29
f1-score 0.7246546020626581
AUC según el mejor F1-score 0.9081298067076746
Confusion Matrix:
 [[15071  1394]
 [ 1436  3724]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_138561.png
Accuracy:   0.8691
Precision:  0.7276
Recall:     0.7217
F1-score:   0.7247

--- Iteración 2 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6933, Test Loss: 0.6947, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6958, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6901, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_138561.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6371, Test Loss: 0.5471, F1: 0.5787, AUC: 0.8210
Epoch [10/30] Train Loss: 0.4368, Test Loss: 0.4917, F1: 0.6519, AUC: 0.8926
Epoch [20/30] Train Loss: 0.4110, Test Loss: 0.3947, F1: 0.6978, AUC: 0.9009
Mejores resultados en la época:  29
f1-score 0.7214758371766593
AUC según el mejor F1-score 0.9066094864135104
Confusion Matrix:
 [[15249  1216]
 [ 1562  3598]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_138561.png
Accuracy:   0.8715
Precision:  0.7474
Recall:     0.6973
F1-score:   0.7215

--- Iteración 4 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6356, Test Loss: 0.5699, F1: 0.5656, AUC: 0.8211
Epoch [10/30] Train Loss: 0.4339, Test Loss: 0.6437, F1: 0.5797, AUC: 0.8938
Epoch [20/30] Train Loss: 0.4142, Test Loss: 0.4012, F1: 0.6976, AUC: 0.9028
Mejores resultados en la época:  26
f1-score 0.7192753081807994
AUC según el mejor F1-score 0.9072822842440036
Confusion Matrix:
 [[14768  1697]
 [ 1309  3851]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_138561.png
Accuracy:   0.8610
Precision:  0.6941
Recall:     0.7463
F1-score:   0.7193
Tiempo total para red 2: 266.62 segundos

Entrenando red 3 con capas [2131, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6332, Test Loss: 0.5185, F1: 0.5963, AUC: 0.8321
Epoch [10/30] Train Loss: 0.4349, Test Loss: 0.3942, F1: 0.6996, AUC: 0.8951
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
Epoch [20/30] Train Loss: 0.4194, Test Loss: 0.3259, F1: 0.6923, AUC: 0.9020
Mejores resultados en la época:  26
f1-score 0.720682302771855
AUC según el mejor F1-score 0.9063560830231852
Confusion Matrix:
 [[14725  1740]
 [ 1273  3887]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_283265.png
Accuracy:   0.8607
Precision:  0.6908
Recall:     0.7533
F1-score:   0.7207

--- Iteración 2 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6551, Test Loss: 0.7272, F1: 0.4808, AUC: 0.8207
Epoch [10/30] Train Loss: 0.4282, Test Loss: 0.4395, F1: 0.6764, AUC: 0.8938
Epoch [20/30] Train Loss: 0.4130, Test Loss: 0.5083, F1: 0.6429, AUC: 0.9020
Mejores resultados en la época:  29
f1-score 0.7189026291177387
AUC según el mejor F1-score 0.9057452736248137
Confusion Matrix:
 [[15461  1004]
 [ 1701  3459]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_283265.png
Accuracy:   0.8749
Precision:  0.7750
Recall:     0.6703
F1-score:   0.7189

--- Iteración 3 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6281, Test Loss: 0.4889, F1: 0.6012, AUC: 0.8312
Epoch [10/30] Train Loss: 0.4310, Test Loss: 0.4459, F1: 0.6730, AUC: 0.8942
Epoch [20/30] Train Loss: 0.4084, Test Loss: 0.3241, F1: 0.7031, AUC: 0.9039
Mejores resultados en la época:  27
f1-score 0.724029593594811
AUC según el mejor F1-score 0.9086656567725289
Confusion Matrix:
 [[15330  1135]
 [ 1588  3572]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_283265.png
Accuracy:   0.8741
Precision:  0.7589
Recall:     0.6922
F1-score:   0.7240

--- Iteración 4 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6253, Test Loss: 0.5889, F1: 0.5657, AUC: 0.8364
Epoch [10/30] Train Loss: 0.4346, Test Loss: 0.5325, F1: 0.6316, AUC: 0.8942
Epoch [20/30] Train Loss: 0.4133, Test Loss: 0.3977, F1: 0.6979, AUC: 0.9022
Mejores resultados en la época:  23
f1-score 0.7217004448838359
AUC según el mejor F1-score 0.9055326838466374
Confusion Matrix:
 [[15160  1305]
 [ 1510  3650]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_283265.png
Accuracy:   0.8698
Precision:  0.7366
Recall:     0.7074
F1-score:   0.7217
Tiempo total para red 3: 280.17 segundos

Entrenando red 4 con capas [2131, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6123, Test Loss: 0.7637, F1: 0.5053, AUC: 0.8464
Epoch [10/30] Train Loss: 0.4302, Test Loss: 0.4079, F1: 0.6959, AUC: 0.8952
Epoch [20/30] Train Loss: 0.4211, Test Loss: 0.3360, F1: 0.6562, AUC: 0.8989
Mejores resultados en la época:  28
f1-score 0.7240344593940568
AUC según el mejor F1-score 0.9067541143181331
Confusion Matrix:
 [[15034  1431]
 [ 1420  3740]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_589057.png
Accuracy:   0.8682
Precision:  0.7233
Recall:     0.7248
F1-score:   0.7240

--- Iteración 2 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6427, Test Loss: 0.5670, F1: 0.5766, AUC: 0.8312
Epoch [10/30] Train Loss: 0.4325, Test Loss: 0.4780, F1: 0.6613, AUC: 0.8933
Epoch [20/30] Train Loss: 0.4118, Test Loss: 0.3733, F1: 0.7140, AUC: 0.9033
Mejores resultados en la época:  26
f1-score 0.7201477226097661
AUC según el mejor F1-score 0.9080315774358104
Confusion Matrix:
 [[15387  1078]
 [ 1650  3510]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_589057.png
Accuracy:   0.8738
Precision:  0.7650
Recall:     0.6802
F1-score:   0.7201

--- Iteración 3 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6922, Test Loss: 0.6994, F1: 0.3853, AUC: 0.7544
Epoch [10/30] Train Loss: 0.4392, Test Loss: 0.4886, F1: 0.6564, AUC: 0.8913
Epoch [20/30] Train Loss: 0.4116, Test Loss: 0.3497, F1: 0.7171, AUC: 0.9001
Mejores resultados en la época:  29
f1-score 0.7192583840770699
AUC según el mejor F1-score 0.9050852407149766
Confusion Matrix:
 [[14579  1886]
 [ 1203  3957]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_589057.png
Accuracy:   0.8572
Precision:  0.6772
Recall:     0.7669
F1-score:   0.7193

--- Iteración 4 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6768, Test Loss: 0.5595, F1: 0.5426, AUC: 0.7876
Epoch [10/30] Train Loss: 0.4337, Test Loss: 0.5571, F1: 0.6202, AUC: 0.8937
Epoch [20/30] Train Loss: 0.4148, Test Loss: 0.3734, F1: 0.6556, AUC: 0.8962
Mejores resultados en la época:  28
f1-score 0.7221699001695234
AUC según el mejor F1-score 0.907636647622276
Confusion Matrix:
 [[14841  1624]
 [ 1326  3834]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_589057.png
Accuracy:   0.8636
Precision:  0.7025
Recall:     0.7430
F1-score:   0.7222
Tiempo total para red 4: 297.20 segundos

Entrenando red 5 con capas [2131, 512, 256, 128, 64, 1]

--- Iteración 1 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6184, Test Loss: 0.4870, F1: 0.6225, AUC: 0.8446
Epoch [10/30] Train Loss: 0.4469, Test Loss: 0.3719, F1: 0.7055, AUC: 0.8927
Epoch [20/30] Train Loss: 0.4158, Test Loss: 0.4089, F1: 0.6949, AUC: 0.9038
Mejores resultados en la época:  28
f1-score 0.7249760765550239
AUC según el mejor F1-score 0.9079265390292306
Confusion Matrix:
 [[14963  1502]
 [ 1372  3788]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_1264129.png
Accuracy:   0.8671
Precision:  0.7161
Recall:     0.7341
F1-score:   0.7250

--- Iteración 2 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6933, Test Loss: 0.6876, F1: 0.0000, AUC: 0.4999
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6921, F1: 0.0000, AUC: 0.4999
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6913, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  1
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5000303674460977
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_1264129.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6113, Test Loss: 0.5685, F1: 0.5884, AUC: 0.8439
Epoch [10/30] Train Loss: 0.4362, Test Loss: 0.4190, F1: 0.6942, AUC: 0.8946
Epoch [20/30] Train Loss: 0.4127, Test Loss: 0.3471, F1: 0.7174, AUC: 0.9025
Mejores resultados en la época:  28
f1-score 0.7207335710646969
AUC según el mejor F1-score 0.90782582621817
Confusion Matrix:
 [[15347  1118]
 [ 1623  3537]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_1264129.png
Accuracy:   0.8732
Precision:  0.7598
Recall:     0.6855
F1-score:   0.7207

--- Iteración 4 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6239, Test Loss: 0.4752, F1: 0.6107, AUC: 0.8380
Epoch [10/30] Train Loss: 0.4392, Test Loss: 0.3557, F1: 0.6820, AUC: 0.8952
Epoch [20/30] Train Loss: 0.4150, Test Loss: 0.3838, F1: 0.7076, AUC: 0.9039
Mejores resultados en la época:  19
f1-score 0.717330116606353
AUC según el mejor F1-score 0.9000328980666059
Confusion Matrix:
 [[15245  1220]
 [ 1592  3568]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_1264129.png
Accuracy:   0.8700
Precision:  0.7452
Recall:     0.6915
F1-score:   0.7173
Tiempo total para red 5: 301.76 segundos

Entrenando red 6 con capas [2131, 1024, 512, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6405, Test Loss: 0.5546, F1: 0.5837, AUC: 0.8319
Epoch [10/30] Train Loss: 0.4409, Test Loss: 0.3618, F1: 0.7040, AUC: 0.8928
Epoch [20/30] Train Loss: 0.4135, Test Loss: 0.3252, F1: 0.6987, AUC: 0.9001
Mejores resultados en la época:  24
f1-score 0.7192592592592593
AUC según el mejor F1-score 0.9030335901618891
Confusion Matrix:
 [[14709  1756]
 [ 1276  3884]]
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/svm/_base.py:305: ConvergenceWarning: Solver terminated early (max_iter=1000).  Consider pre-processing your data with StandardScaler or MinMaxScaler.
  warnings.warn(
/home/marcelino.maita/.venv/lib/python3.13/site-packages/xgboost/training.py:183: UserWarning: [00:44:39] WARNING: /workspace/src/learner.cc:738: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_2882561.png
Accuracy:   0.8598
Precision:  0.6887
Recall:     0.7527
F1-score:   0.7193

--- Iteración 2 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6623, Test Loss: 0.5009, F1: 0.5910, AUC: 0.8232
Epoch [10/30] Train Loss: 0.4332, Test Loss: 0.3547, F1: 0.7017, AUC: 0.8935
Epoch [20/30] Train Loss: 0.4191, Test Loss: 0.3346, F1: 0.7080, AUC: 0.9011
Mejores resultados en la época:  29
f1-score 0.7265751211631664
AUC según el mejor F1-score 0.9064244568582169
Confusion Matrix:
 [[15319  1146]
 [ 1562  3598]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_2882561.png
Accuracy:   0.8748
Precision:  0.7584
Recall:     0.6973
F1-score:   0.7266

--- Iteración 3 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6588, Test Loss: 0.5733, F1: 0.5616, AUC: 0.8215
Epoch [10/30] Train Loss: 0.4287, Test Loss: 0.4337, F1: 0.6835, AUC: 0.8937
Epoch [20/30] Train Loss: 0.4137, Test Loss: 0.3980, F1: 0.6952, AUC: 0.9026
Mejores resultados en la época:  27
f1-score 0.722654028436019
AUC según el mejor F1-score 0.9065601275432735
Confusion Matrix:
 [[14887  1578]
 [ 1348  3812]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_2882561.png
Accuracy:   0.8647
Precision:  0.7072
Recall:     0.7388
F1-score:   0.7227

--- Iteración 4 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6919, Test Loss: 0.6715, F1: 0.3782, AUC: 0.7414
Epoch [10/30] Train Loss: 0.4318, Test Loss: 0.5375, F1: 0.6303, AUC: 0.8922
Epoch [20/30] Train Loss: 0.4105, Test Loss: 0.3419, F1: 0.7154, AUC: 0.9001
Mejores resultados en la época:  26
f1-score 0.7205897202867818
AUC según el mejor F1-score 0.9038980265868168
Confusion Matrix:
 [[15290  1175]
 [ 1592  3568]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/lyrics_bert/confusion_matrix_param_2882561.png
Accuracy:   0.8720
Precision:  0.7523
Recall:     0.6915
F1-score:   0.7206
Tiempo total para red 6: 334.49 segundos
Saved on: outputs_main_numerical_categorical_metadata/0/lyrics_bert

==============================
Model: Logistic Regression
Accuracy:  0.8447
Precision: 0.6332
Recall:    0.8300
F1-score:  0.7184
              precision    recall  f1-score   support

           0       0.94      0.85      0.89     16465
           1       0.63      0.83      0.72      5160

    accuracy                           0.84     21625
   macro avg       0.79      0.84      0.81     21625
weighted avg       0.87      0.84      0.85     21625

[[13984  2481]
 [  877  4283]]
Hiperparámetros: {'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 1000, 'multi_class': 'deprecated', 'n_jobs': None, 'penalty': 'l2', 'random_state': 42, 'solver': 'lbfgs', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_logistic_regression.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/logistic_regression_model.pkl

==============================
Model: SVM
Accuracy:  0.3950
Precision: 0.2573
Recall:    0.8138
F1-score:  0.3910
              precision    recall  f1-score   support

           0       0.82      0.26      0.40     16465
           1       0.26      0.81      0.39      5160

    accuracy                           0.40     21625
   macro avg       0.54      0.54      0.39     21625
weighted avg       0.68      0.40      0.40     21625

[[ 4343 12122]
 [  961  4199]]
Hiperparámetros: {'C': 1.0, 'break_ties': False, 'cache_size': 200, 'class_weight': None, 'coef0': 0.0, 'decision_function_shape': 'ovr', 'degree': 3, 'gamma': 'scale', 'kernel': 'rbf', 'max_iter': 1000, 'probability': False, 'random_state': 42, 'shrinking': True, 'tol': 0.001, 'verbose': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_svm.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/svm_model.pkl

==============================
Model: Decision Tree
Accuracy:  0.8345
Precision: 0.6212
Recall:    0.7851
F1-score:  0.6936
              precision    recall  f1-score   support

           0       0.93      0.85      0.89     16465
           1       0.62      0.79      0.69      5160

    accuracy                           0.83     21625
   macro avg       0.77      0.82      0.79     21625
weighted avg       0.85      0.83      0.84     21625

[[13995  2470]
 [ 1109  4051]]
Hiperparámetros: {'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'entropy', 'max_depth': 10, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'random_state': 42, 'splitter': 'best'}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_decision_tree.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/decision_tree_model.pkl

==============================
Model: Random Forest
Accuracy:  0.8601
Precision: 0.6724
Recall:    0.8070
F1-score:  0.7336
              precision    recall  f1-score   support

           0       0.94      0.88      0.91     16465
           1       0.67      0.81      0.73      5160

    accuracy                           0.86     21625
   macro avg       0.80      0.84      0.82     21625
weighted avg       0.87      0.86      0.86     21625

[[14436  2029]
 [  996  4164]]
Hiperparámetros: {'bootstrap': True, 'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'gini', 'max_depth': 15, 'max_features': 'sqrt', 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'n_estimators': 200, 'n_jobs': -1, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_random_forest.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/random_forest_model.pkl

==============================
Model: XGBoost
Accuracy:  0.8822
Precision: 0.7128
Recall:    0.8479
F1-score:  0.7745
              precision    recall  f1-score   support

           0       0.95      0.89      0.92     16465
           1       0.71      0.85      0.77      5160

    accuracy                           0.88     21625
   macro avg       0.83      0.87      0.85     21625
weighted avg       0.89      0.88      0.89     21625

[[14702  1763]
 [  785  4375]]
Hiperparámetros: {'objective': 'binary:logistic', 'base_score': None, 'booster': None, 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.8, 'device': None, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'logloss', 'feature_types': None, 'feature_weights': None, 'gamma': None, 'grow_policy': None, 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.1, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 8, 'max_leaves': None, 'min_child_weight': None, 'missing': nan, 'monotone_constraints': None, 'multi_strategy': None, 'n_estimators': 200, 'n_jobs': None, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': None, 'reg_lambda': None, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': 0.8, 'tree_method': None, 'validate_parameters': None, 'verbosity': None, 'use_label_encoder': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_xgboost.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/xgboost_model.pkl

==============================
Model: Naive Bayes
Accuracy:  0.7705
Precision: 0.5135
Recall:    0.7207
F1-score:  0.5997
              precision    recall  f1-score   support

           0       0.90      0.79      0.84     16465
           1       0.51      0.72      0.60      5160

    accuracy                           0.77     21625
   macro avg       0.71      0.75      0.72     21625
weighted avg       0.81      0.77      0.78     21625
/home/marcelino.maita/musica_ia_workshop/models_comparison/testing_organized/preprocessed_data/main_numerical_categorical_metadata.py:281: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  .apply(lambda grp: grp.sample(n=n_min, random_state=RANDOM_STATE))
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])

[[12942  3523]
 [ 1441  3719]]
Hiperparámetros: {'priors': None, 'var_smoothing': 1e-09}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/lyrics_bert/conf_matrix_naive_bayes.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/lyrics_bert/naive_bayes_model.pkl


Resumen de métricas:
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.7705, 'precision': 0.5135, 'recall': 0.7207, 'f1_score': 0.5997}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}
Contaning the categorical cols
Nuevas dimensiones X con categóricas: (108125, 2085)
Tamanio:  (108125, 43)
Total de columnas:  43
Columnas numericas usadas:  ['Tempo', 'Length', 'Loudness (db)', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Release_Year', 'Release_Month', 'Release_Day']
Columnas del df:  ['Artist(s)', 'song', 'text', 'Length', 'emotion', 'Genre', 'Album', 'Key', 'Tempo', 'Loudness (db)', 'Time signature', 'Explicit', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Similar Artist 1', 'Similar Song 1', 'Similarity Score 1', 'Similar Artist 2', 'Similar Song 2', 'Similarity Score 2', 'Similar Artist 3', 'Similar Song 3', 'Similarity Score 3', 'song_normalized', 'artist_normalized', 'Release_Year', 'Release_Month', 'Release_Day']
<class 'numpy.ndarray'> <class 'pandas.core.series.Series'>
(108125, 2131)
(108125,)

Splitting data...

Data con el spliting...
Label distribution en TRAIN: {0: 65861, 1: 20639}
Label distribution en TEST: {0: 16465, 1: 5160}


==================================================
Data antes del undersampling ...
X: (86500, 2131)
y: (86500,)
Apliying UNDERSAMPLE
20639
Label distribution: {0: 20639, 1: 20639}
X shape: (41278, 2131)
y shape: (41278,)
Resultados con MLP

Entrenando red 1 con capas [2131, 32, 1]

--- Iteración 1 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6937, Test Loss: 0.6950, F1: 0.3853, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6913, F1: 0.0000, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6927, F1: 0.0000, AUC: 0.5000
Mejores resultados en la época:  0
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_68257.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 2 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6237, Test Loss: 0.6393, F1: 0.5260, AUC: 0.8233
Epoch [10/30] Train Loss: 0.4340, Test Loss: 0.4123, F1: 0.6930, AUC: 0.8920
Epoch [20/30] Train Loss: 0.4124, Test Loss: 0.7785, F1: 0.5296, AUC: 0.9005
Mejores resultados en la época:  27
f1-score 0.7217194570135747
AUC según el mejor F1-score 0.9058172491801967
Confusion Matrix:
 [[14845  1620]
 [ 1332  3828]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_68257.png
Accuracy:   0.8635
Precision:  0.7026
Recall:     0.7419
F1-score:   0.7217

--- Iteración 3 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6931, Test Loss: 0.6901, F1: 0.0000, AUC: 0.5000
Epoch [10/30] Train Loss: 0.6931, Test Loss: 0.6968, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6949, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  17
f1-score 0.38530465949820786
AUC según el mejor F1-score 0.5000303674460977
Confusion Matrix:
 [[    1 16464]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_68257.png
Accuracy:   0.2387
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 4 de 4 para la red 1 ---
Epoch [0/30] Train Loss: 0.6196, Test Loss: 0.4919, F1: 0.5922, AUC: 0.8246
Epoch [10/30] Train Loss: 0.4327, Test Loss: 0.4495, F1: 0.6727, AUC: 0.8935
Epoch [20/30] Train Loss: 0.4100, Test Loss: 0.3650, F1: 0.7150, AUC: 0.9026
Mejores resultados en la época:  26
f1-score 0.7211538461538461
AUC según el mejor F1-score 0.9065912482903599
Confusion Matrix:
 [[15108  1357]
 [ 1485  3675]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_68257.png
Accuracy:   0.8686
Precision:  0.7303
Recall:     0.7122
F1-score:   0.7212
Tiempo total para red 1: 250.29 segundos

Entrenando red 2 con capas [2131, 64, 32, 1]

--- Iteración 1 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6222, Test Loss: 0.5535, F1: 0.5800, AUC: 0.8305
Epoch [10/30] Train Loss: 0.4298, Test Loss: 0.3669, F1: 0.7044, AUC: 0.8942
Epoch [20/30] Train Loss: 0.4141, Test Loss: 0.4701, F1: 0.6615, AUC: 0.9026
Mejores resultados en la época:  26
f1-score 0.7212720717389295
AUC según el mejor F1-score 0.9065888059473112
Confusion Matrix:
 [[14709  1756]
 [ 1259  3901]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_138561.png
Accuracy:   0.8606
Precision:  0.6896
Recall:     0.7560
F1-score:   0.7213

--- Iteración 2 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6415, Test Loss: 0.5995, F1: 0.5450, AUC: 0.8137
Epoch [10/30] Train Loss: 0.4323, Test Loss: 0.4241, F1: 0.6856, AUC: 0.8929
Epoch [20/30] Train Loss: 0.4172, Test Loss: 0.3661, F1: 0.7140, AUC: 0.9013
Mejores resultados en la época:  29
f1-score 0.7265700483091787
AUC según el mejor F1-score 0.9070799169956474
Confusion Matrix:
 [[15035  1430]
 [ 1400  3760]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_138561.png
Accuracy:   0.8691
Precision:  0.7245
Recall:     0.7287
F1-score:   0.7266

--- Iteración 3 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6411, Test Loss: 0.4782, F1: 0.5693, AUC: 0.8143
Epoch [10/30] Train Loss: 0.4296, Test Loss: 0.4739, F1: 0.6593, AUC: 0.8931
Epoch [20/30] Train Loss: 0.4062, Test Loss: 0.3278, F1: 0.6680, AUC: 0.9020
Mejores resultados en la época:  27
f1-score 0.7212686941684232
AUC según el mejor F1-score 0.9066229516686795
Confusion Matrix:
 [[15255  1210]
 [ 1567  3593]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_138561.png
Accuracy:   0.8716
Precision:  0.7481
Recall:     0.6963
F1-score:   0.7213

--- Iteración 4 de 4 para la red 2 ---
Epoch [0/30] Train Loss: 0.6213, Test Loss: 0.4446, F1: 0.5923, AUC: 0.8304
Epoch [10/30] Train Loss: 0.4340, Test Loss: 0.6122, F1: 0.5916, AUC: 0.8938
Epoch [20/30] Train Loss: 0.4132, Test Loss: 0.4030, F1: 0.6949, AUC: 0.9021
Mejores resultados en la época:  27
f1-score 0.7229674796747968
AUC según el mejor F1-score 0.9070098070372435
Confusion Matrix:
 [[15342  1123]
 [ 1603  3557]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_138561.png
Accuracy:   0.8739
Precision:  0.7600
Recall:     0.6893
F1-score:   0.7230
Tiempo total para red 2: 265.65 segundos

Entrenando red 3 con capas [2131, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6252, Test Loss: 0.4196, F1: 0.5478, AUC: 0.8329
Epoch [10/30] Train Loss: 0.4343, Test Loss: 0.3909, F1: 0.6986, AUC: 0.8936
Epoch [20/30] Train Loss: 0.4132, Test Loss: 0.3953, F1: 0.7029, AUC: 0.9024
Mejores resultados en la época:  28
f1-score 0.7222327341532639
AUC según el mejor F1-score 0.9071506978627437
Confusion Matrix:
 [[14872  1593]
 [ 1343  3817]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_283265.png
Accuracy:   0.8642
Precision:  0.7055
Recall:     0.7397
F1-score:   0.7222

--- Iteración 2 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6320, Test Loss: 0.5663, F1: 0.5742, AUC: 0.8321
Epoch [10/30] Train Loss: 0.4357, Test Loss: 0.5395, F1: 0.6318, AUC: 0.8937
Epoch [20/30] Train Loss: 0.4117, Test Loss: 0.3969, F1: 0.7009, AUC: 0.9024
Mejores resultados en la época:  29
f1-score 0.7250368912936547
AUC según el mejor F1-score 0.9083476519372783
Confusion Matrix:
 [[15145  1320]
 [ 1475  3685]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_283265.png
Accuracy:   0.8708
Precision:  0.7363
Recall:     0.7141
F1-score:   0.7250

--- Iteración 3 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6321, Test Loss: 0.5490, F1: 0.5833, AUC: 0.8320
Epoch [10/30] Train Loss: 0.4329, Test Loss: 0.4460, F1: 0.6737, AUC: 0.8936
Epoch [20/30] Train Loss: 0.4177, Test Loss: 0.3374, F1: 0.6898, AUC: 0.9020
Mejores resultados en la época:  27
f1-score 0.719679007842422
AUC según el mejor F1-score 0.9064513402872432
Confusion Matrix:
 [[14605  1860]
 [ 1214  3946]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_283265.png
Accuracy:   0.8578
Precision:  0.6796
Recall:     0.7647
F1-score:   0.7197

--- Iteración 4 de 4 para la red 3 ---
Epoch [0/30] Train Loss: 0.6206, Test Loss: 0.5347, F1: 0.5926, AUC: 0.8375
Epoch [10/30] Train Loss: 0.4371, Test Loss: 0.3649, F1: 0.7029, AUC: 0.8947
Epoch [20/30] Train Loss: 0.4215, Test Loss: 0.4284, F1: 0.6860, AUC: 0.9009
Mejores resultados en la época:  25
f1-score 0.7219756897549682
AUC según el mejor F1-score 0.9067296555766637
Confusion Matrix:
 [[15001  1464]
 [ 1418  3742]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_283265.png
Accuracy:   0.8667
Precision:  0.7188
Recall:     0.7252
F1-score:   0.7220
Tiempo total para red 3: 278.17 segundos

Entrenando red 4 con capas [2131, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6222, Test Loss: 0.6585, F1: 0.5370, AUC: 0.8401
Epoch [10/30] Train Loss: 0.4306, Test Loss: 0.3879, F1: 0.7028, AUC: 0.8943
Epoch [20/30] Train Loss: 0.4160, Test Loss: 0.5040, F1: 0.6561, AUC: 0.9030
Mejores resultados en la época:  29
f1-score 0.7222997488138432
AUC según el mejor F1-score 0.9080773345856962
Confusion Matrix:
 [[14758  1707]
 [ 1278  3882]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_589057.png
Accuracy:   0.8620
Precision:  0.6946
Recall:     0.7523
F1-score:   0.7223

--- Iteración 2 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6389, Test Loss: 0.4669, F1: 0.5949, AUC: 0.8285
Epoch [10/30] Train Loss: 0.4354, Test Loss: 0.4088, F1: 0.6927, AUC: 0.8941
Epoch [20/30] Train Loss: 0.4095, Test Loss: 0.3771, F1: 0.7048, AUC: 0.9024
Mejores resultados en la época:  29
f1-score 0.7297063071738084
AUC según el mejor F1-score 0.9087076533026365
Confusion Matrix:
 [[15029  1436]
 [ 1371  3789]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_589057.png
Accuracy:   0.8702
Precision:  0.7252
Recall:     0.7343
F1-score:   0.7297

--- Iteración 3 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6572, Test Loss: 0.5655, F1: 0.5728, AUC: 0.8252
Epoch [10/30] Train Loss: 0.4317, Test Loss: 0.5169, F1: 0.6383, AUC: 0.8932
Epoch [20/30] Train Loss: 0.4203, Test Loss: 0.3526, F1: 0.7160, AUC: 0.9009
Mejores resultados en la época:  27
f1-score 0.7248257164988381
AUC según el mejor F1-score 0.9050442682034007
Confusion Matrix:
 [[15040  1425]
 [ 1417  3743]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_589057.png
Accuracy:   0.8686
Precision:  0.7243
Recall:     0.7254
F1-score:   0.7248

--- Iteración 4 de 4 para la red 4 ---
Epoch [0/30] Train Loss: 0.6059, Test Loss: 0.6020, F1: 0.5646, AUC: 0.8485
Epoch [10/30] Train Loss: 0.4441, Test Loss: 0.3513, F1: 0.6982, AUC: 0.8931
Epoch [20/30] Train Loss: 0.4158, Test Loss: 0.4939, F1: 0.6654, AUC: 0.9043
Mejores resultados en la época:  28
f1-score 0.7240539527913076
AUC según el mejor F1-score 0.9089330550827808
Confusion Matrix:
 [[14814  1651]
 [ 1295  3865]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_589057.png
Accuracy:   0.8638
Precision:  0.7007
Recall:     0.7490
F1-score:   0.7241
Tiempo total para red 4: 292.63 segundos

Entrenando red 5 con capas [2131, 512, 256, 128, 64, 1]

--- Iteración 1 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6062, Test Loss: 0.8742, F1: 0.4637, AUC: 0.8506
Epoch [10/30] Train Loss: 0.4369, Test Loss: 0.3400, F1: 0.6506, AUC: 0.8949
Epoch [20/30] Train Loss: 0.4072, Test Loss: 0.4383, F1: 0.6859, AUC: 0.9054
Mejores resultados en la época:  29
f1-score 0.724266375942582
AUC según el mejor F1-score 0.9106094322700018
Confusion Matrix:
 [[14604  1861]
 [ 1174  3986]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_1264129.png
Accuracy:   0.8597
Precision:  0.6817
Recall:     0.7725
F1-score:   0.7243

--- Iteración 2 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6227, Test Loss: 0.5535, F1: 0.5868, AUC: 0.8440
Epoch [10/30] Train Loss: 0.4381, Test Loss: 0.4275, F1: 0.6855, AUC: 0.8935
Epoch [20/30] Train Loss: 0.4168, Test Loss: 0.3884, F1: 0.7016, AUC: 0.9028
Mejores resultados en la época:  26
f1-score 0.7164719731956896
AUC según el mejor F1-score 0.9067255065360631
Confusion Matrix:
 [[14538  1927]
 [ 1204  3956]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_1264129.png
Accuracy:   0.8552
Precision:  0.6724
Recall:     0.7667
F1-score:   0.7165

--- Iteración 3 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6163, Test Loss: 0.4531, F1: 0.6210, AUC: 0.8462
Epoch [10/30] Train Loss: 0.4413, Test Loss: 0.4576, F1: 0.6830, AUC: 0.8942
Epoch [20/30] Train Loss: 0.4163, Test Loss: 0.3738, F1: 0.7134, AUC: 0.9007
Mejores resultados en la época:  28
f1-score 0.715028646981049
AUC según el mejor F1-score 0.9051289086316523
Confusion Matrix:
 [[14336  2129]
 [ 1104  4056]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_1264129.png
Accuracy:   0.8505
Precision:  0.6558
Recall:     0.7860
F1-score:   0.7150

--- Iteración 4 de 4 para la red 5 ---
Epoch [0/30] Train Loss: 0.6171, Test Loss: 0.5499, F1: 0.5948, AUC: 0.8479
Epoch [10/30] Train Loss: 0.4373, Test Loss: 0.5298, F1: 0.6292, AUC: 0.8943
Epoch [20/30] Train Loss: 0.4137, Test Loss: 0.4010, F1: 0.7037, AUC: 0.9007
Mejores resultados en la época:  29
f1-score 0.7239263803680982
AUC según el mejor F1-score 0.9051506013460546
Confusion Matrix:
 [[14969  1496]
 [ 1384  3776]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_1264129.png
Accuracy:   0.8668
Precision:  0.7162
Recall:     0.7318
F1-score:   0.7239
Tiempo total para red 5: 298.75 segundos

Entrenando red 6 con capas [2131, 1024, 512, 256, 128, 64, 32, 1]

--- Iteración 1 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6910, Test Loss: 0.6814, F1: 0.0790, AUC: 0.7517
Epoch [10/30] Train Loss: 0.4341, Test Loss: 0.4459, F1: 0.6748, AUC: 0.8929
Epoch [20/30] Train Loss: 0.4220, Test Loss: 0.3372, F1: 0.7154, AUC: 0.9034
Mejores resultados en la época:  29
f1-score 0.7260668973471741
AUC según el mejor F1-score 0.9098071549469511
Confusion Matrix:
 [[14998  1467]
 [ 1383  3777]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_2882561.png
Accuracy:   0.8682
Precision:  0.7203
Recall:     0.7320
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1731: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/home/marcelino.maita/.venv/lib/python3.13/site-packages/sklearn/svm/_base.py:305: ConvergenceWarning: Solver terminated early (max_iter=1000).  Consider pre-processing your data with StandardScaler or MinMaxScaler.
  warnings.warn(
/home/marcelino.maita/.venv/lib/python3.13/site-packages/xgboost/training.py:183: UserWarning: [01:17:10] WARNING: /workspace/src/learner.cc:738: 
Parameters: { "use_label_encoder" } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
F1-score:   0.7261

--- Iteración 2 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6922, Test Loss: 0.6921, F1: 0.0000, AUC: 0.3483
Epoch [10/30] Train Loss: 0.6932, Test Loss: 0.6972, F1: 0.3853, AUC: 0.5000
Epoch [20/30] Train Loss: 0.6932, Test Loss: 0.6964, F1: 0.3853, AUC: 0.5000
Mejores resultados en la época:  2
f1-score 0.3852902744073175
AUC según el mejor F1-score 0.5931204787227781
Confusion Matrix:
 [[    0 16465]
 [    0  5160]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_2882561.png
Accuracy:   0.2386
Precision:  0.2386
Recall:     1.0000
F1-score:   0.3853

--- Iteración 3 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6093, Test Loss: 0.4782, F1: 0.6311, AUC: 0.8494
Epoch [10/30] Train Loss: 0.4402, Test Loss: 0.4108, F1: 0.6964, AUC: 0.8938
Epoch [20/30] Train Loss: 0.4171, Test Loss: 0.4252, F1: 0.6897, AUC: 0.9038
Mejores resultados en la época:  28
f1-score 0.7230873392010833
AUC según el mejor F1-score 0.9082157771829839
Confusion Matrix:
 [[15024  1441]
 [ 1422  3738]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_2882561.png
Accuracy:   0.8676
Precision:  0.7218
Recall:     0.7244
F1-score:   0.7231

--- Iteración 4 de 4 para la red 6 ---
Epoch [0/30] Train Loss: 0.6932, Test Loss: 0.7058, F1: 0.3853, AUC: 0.7438
Epoch [10/30] Train Loss: 0.4351, Test Loss: 0.3875, F1: 0.7004, AUC: 0.8915
Epoch [20/30] Train Loss: 0.4190, Test Loss: 0.3997, F1: 0.6990, AUC: 0.8990
Mejores resultados en la época:  27
f1-score 0.7167492203265455
AUC según el mejor F1-score 0.9042294672514164
Confusion Matrix:
 [[14630  1835]
 [ 1253  3907]]
Matriz de confusión guardada en: outputs_main_numerical_categorical_metadata/0/gpt/confusion_matrix_param_2882561.png
Accuracy:   0.8572
Precision:  0.6804
Recall:     0.7572
F1-score:   0.7167
Tiempo total para red 6: 339.49 segundos
Saved on: outputs_main_numerical_categorical_metadata/0/gpt

==============================
Model: Logistic Regression
Accuracy:  0.8447
Precision: 0.6332
Recall:    0.8300
F1-score:  0.7184
              precision    recall  f1-score   support

           0       0.94      0.85      0.89     16465
           1       0.63      0.83      0.72      5160

    accuracy                           0.84     21625
   macro avg       0.79      0.84      0.81     21625
weighted avg       0.87      0.84      0.85     21625

[[13984  2481]
 [  877  4283]]
Hiperparámetros: {'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 1000, 'multi_class': 'deprecated', 'n_jobs': None, 'penalty': 'l2', 'random_state': 42, 'solver': 'lbfgs', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_logistic_regression.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/logistic_regression_model.pkl

==============================
Model: SVM
Accuracy:  0.3950
Precision: 0.2573
Recall:    0.8138
F1-score:  0.3910
              precision    recall  f1-score   support

           0       0.82      0.26      0.40     16465
           1       0.26      0.81      0.39      5160

    accuracy                           0.40     21625
   macro avg       0.54      0.54      0.39     21625
weighted avg       0.68      0.40      0.40     21625

[[ 4343 12122]
 [  961  4199]]
Hiperparámetros: {'C': 1.0, 'break_ties': False, 'cache_size': 200, 'class_weight': None, 'coef0': 0.0, 'decision_function_shape': 'ovr', 'degree': 3, 'gamma': 'scale', 'kernel': 'rbf', 'max_iter': 1000, 'probability': False, 'random_state': 42, 'shrinking': True, 'tol': 0.001, 'verbose': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_svm.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/svm_model.pkl

==============================
Model: Decision Tree
Accuracy:  0.8345
Precision: 0.6212
Recall:    0.7851
F1-score:  0.6936
              precision    recall  f1-score   support

           0       0.93      0.85      0.89     16465
           1       0.62      0.79      0.69      5160

    accuracy                           0.83     21625
   macro avg       0.77      0.82      0.79     21625
weighted avg       0.85      0.83      0.84     21625

[[13995  2470]
 [ 1109  4051]]
Hiperparámetros: {'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'entropy', 'max_depth': 10, 'max_features': None, 'max_leaf_nodes': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'random_state': 42, 'splitter': 'best'}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_decision_tree.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/decision_tree_model.pkl

==============================
Model: Random Forest
Accuracy:  0.8601
Precision: 0.6724
Recall:    0.8070
F1-score:  0.7336
              precision    recall  f1-score   support

           0       0.94      0.88      0.91     16465
           1       0.67      0.81      0.73      5160

    accuracy                           0.86     21625
   macro avg       0.80      0.84      0.82     21625
weighted avg       0.87      0.86      0.86     21625

[[14436  2029]
 [  996  4164]]
Hiperparámetros: {'bootstrap': True, 'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'gini', 'max_depth': 15, 'max_features': 'sqrt', 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 1, 'min_samples_split': 2, 'min_weight_fraction_leaf': 0.0, 'monotonic_cst': None, 'n_estimators': 200, 'n_jobs': -1, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_random_forest.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/random_forest_model.pkl

==============================
Model: XGBoost
Accuracy:  0.8822
Precision: 0.7128
Recall:    0.8479
F1-score:  0.7745
              precision    recall  f1-score   support

           0       0.95      0.89      0.92     16465
           1       0.71      0.85      0.77      5160

    accuracy                           0.88     21625
   macro avg       0.83      0.87      0.85     21625
weighted avg       0.89      0.88      0.89     21625

[[14702  1763]
 [  785  4375]]
Hiperparámetros: {'objective': 'binary:logistic', 'base_score': None, 'booster': None, 'callbacks': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': 0.8, 'device': None, 'early_stopping_rounds': None, 'enable_categorical': False, 'eval_metric': 'logloss', 'feature_types': None, 'feature_weights': None, 'gamma': None, 'grow_policy': None, 'importance_type': None, 'interaction_constraints': None, 'learning_rate': 0.1, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': 8, 'max_leaves': None, 'min_child_weight': None, 'missing': nan, 'monotone_constraints': None, 'multi_strategy': None, 'n_estimators': 200, 'n_jobs': None, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': None, 'reg_lambda': None, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': 0.8, 'tree_method': None, 'validate_parameters': None, 'verbosity': None, 'use_label_encoder': False}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_xgboost.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/xgboost_model.pkl

==============================
Model: Naive Bayes
Accuracy:  0.7705
Precision: 0.5135
Recall:    0.7207
F1-score:  0.5997
              precision    recall  f1-score   support

           0       0.90      0.79      0.84     16465
           1       0.51      0.72      0.60      5160

    accuracy                           0.77     21625
   macro avg       0.71      0.75      0.72     21625
weighted avg       0.81      0.77      0.78     21625

[[12942  3523]
 [ 1441  3719]]
Hiperparámetros: {'priors': None, 'var_smoothing': 1e-09}
Confusion matrix saved as: outputs_main_numerical_categorical_metadata/0/gpt/conf_matrix_naive_bayes.png
Modelo guardado como: outputs_main_numerical_categorical_metadata/0/gpt/naive_bayes_model.pkl


Resumen de métricas:
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.7705, 'precision': 0.5135, 'recall': 0.7207, 'f1_score': 0.5997}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}


Resumen GLOBAL de métricas:


EMBEDDINGS TYPE: TFIDF
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
MLP_589057: {'accuracy': 0.8600231213872832, 'precision': 0.6870068385060495, 'recall': 0.7593023255813953, 'f1_score': 0.7264677574590953, 'f1_score_avg': 0.7213531766214647}
MLP_1264129: {'accuracy': 0.8618265895953757, 'precision': 0.6926214969847464, 'recall': 0.7567829457364341, 'f1_score': 0.7264677574590953, 'f1_score_avg': 0.7208967802144831}
MLP_2882561: {'accuracy': 0.8637687861271677, 'precision': 0.7087891361750283, 'recall': 0.7282945736434109, 'f1_score': 0.7264677574590953, 'f1_score_avg': 0.6356192653089677}
MLP_283265: {'accuracy': 0.8641849710982659, 'precision': 0.7032364234777839, 'recall': 0.7453488372093023, 'f1_score': 0.7261502845567667, 'f1_score_avg': 0.7225944675928533}
MLP_68257: {'accuracy': 0.23861271676300577, 'precision': 0.23861271676300577, 'recall': 1.0, 'f1_score': 0.725316216726449, 'f1_score_avg': 0.47029675998710035}
MLP_138561: {'accuracy': 0.8647398843930636, 'precision': 0.7105709440361786, 'recall': 0.7308139534883721, 'f1_score': 0.725316216726449, 'f1_score_avg': 0.7208686674967736}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.6766, 'precision': 0.4009, 'recall': 0.7188, 'f1_score': 0.5147}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}


EMBEDDINGS TYPE: LYRICS_BERT
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
MLP_2882561: {'accuracy': 0.8720462427745664, 'precision': 0.7522664979970483, 'recall': 0.6914728682170542, 'f1_score': 0.7265751211631664, 'f1_score_avg': 0.7222695322863066}
MLP_1264129: {'accuracy': 0.8699653179190752, 'precision': 0.7451963241436925, 'recall': 0.6914728682170542, 'f1_score': 0.7249760765550239, 'f1_score_avg': 0.6370825096583479}
MLP_138561: {'accuracy': 0.8609942196531792, 'precision': 0.6941240086517664, 'recall': 0.7463178294573644, 'f1_score': 0.7246546020626581, 'f1_score_avg': 0.6376740054568586}
MLP_283265: {'accuracy': 0.8698265895953757, 'precision': 0.7366296670030272, 'recall': 0.7073643410852714, 'f1_score': 0.7246546020626581, 'f1_score_avg': 0.7213287425920601}
MLP_589057: {'accuracy': 0.8635838150289017, 'precision': 0.7024551117625504, 'recall': 0.7430232558139535, 'f1_score': 0.7246546020626581, 'f1_score_avg': 0.7214026165626041}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.7705, 'precision': 0.5135, 'recall': 0.7207, 'f1_score': 0.5997}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}
MLP_68257: {'accuracy': 0.23861271676300577, 'precision': 0.23861271676300577, 'recall': 1.0, 'f1_score': 0.3852902744073175, 'f1_score_avg': 0.3852902744073175}


EMBEDDINGS TYPE: GPT
XGBoost: {'accuracy': 0.8822, 'precision': 0.7128, 'recall': 0.8479, 'f1_score': 0.7745}
Random Forest: {'accuracy': 0.8601, 'precision': 0.6724, 'recall': 0.807, 'f1_score': 0.7336}
MLP_589057: {'accuracy': 0.8637687861271677, 'precision': 0.7006889050036258, 'recall': 0.749031007751938, 'f1_score': 0.7297063071738084, 'f1_score_avg': 0.7252214313194494}
MLP_1264129: {'accuracy': 0.8668208092485549, 'precision': 0.716236722306525, 'recall': 0.7317829457364341, 'f1_score': 0.7297063071738084, 'f1_score_avg': 0.7199233441218547}
MLP_2882561: {'accuracy': 0.8572023121387283, 'precision': 0.6804249390456287, 'recall': 0.7571705426356589, 'f1_score': 0.7297063071738084, 'f1_score_avg': 0.6377984328205302}
MLP_138561: {'accuracy': 0.873942196531792, 'precision': 0.760042735042735, 'recall': 0.6893410852713179, 'f1_score': 0.7265700483091787, 'f1_score_avg': 0.7230195734728321}
MLP_283265: {'accuracy': 0.866728323699422, 'precision': 0.7187860161352286, 'recall': 0.7251937984496124, 'f1_score': 0.7265700483091787, 'f1_score_avg': 0.7222310807610772}
MLP_68257: {'accuracy': 0.868578034682081, 'precision': 0.7303259141494436, 'recall': 0.7122093023255814, 'f1_score': 0.7217194570135747, 'f1_score_avg': 0.5533670592682366}
Logistic Regression: {'accuracy': 0.8447, 'precision': 0.6332, 'recall': 0.83, 'f1_score': 0.7184}
Decision Tree: {'accuracy': 0.8345, 'precision': 0.6212, 'recall': 0.7851, 'f1_score': 0.6936}
Naive Bayes: {'accuracy': 0.7705, 'precision': 0.5135, 'recall': 0.7207, 'f1_score': 0.5997}
SVM: {'accuracy': 0.395, 'precision': 0.2573, 'recall': 0.8138, 'f1_score': 0.391}

========== CONFIGURATIONS ==========
TESTING: False
UNDERSAMPLING: True
USE_SMOTE: False
SCALED: True
STEAMING: True
REMOVE_STOPWORDS: True
NUMERIC_COLS: True
MAX_FEATURES_TFIDF: 5000
TF-IDF Columns: ['text']
Numeric Columns: ['Tempo', 'Length', 'Loudness (db)', 'Popularity', 'Energy', 'Danceability', 'Positiveness', 'Speechiness', 'Liveness', 'Acousticness', 'Instrumentalness', 'Good for Party', 'Good for Work/Study', 'Good for Relaxation/Meditation', 'Good for Exercise', 'Good for Running', 'Good for Yoga/Stretching', 'Good for Driving', 'Good for Social Gatherings', 'Good for Morning Routine', 'Release_Year', 'Release_Month', 'Release_Day']
====================================

